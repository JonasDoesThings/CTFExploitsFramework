#!/usr/bin/python3

import importlib.util
import os
import sys

from core.logger.Logger import Logger
from core.ui.Banner import Banner

Banner.print_banner()
Logger.info("Initializing LolcatSec Exploits Framework...")

exploits = {}

for root, directories, filenames in os.walk(os.path.realpath(__file__).replace("Lolcats.py", "") + "../modules/"):
    for filename in filenames:
        if "__init__" in filename or "__pycache__" in root:
            continue

        spec = importlib.util.spec_from_file_location("modules", os.path.join(root, filename))
        module = importlib.util.module_from_spec(spec)
        spec.loader.exec_module(module)

        exploitClass = getattr(module, str(filename).replace(".py", ""))
        exploitInstance = exploitClass()
        exploits[exploitInstance.name.lower()] = exploitInstance

Logger.info("Loaded " + str(len(exploits)) + " exploits!")

if "-d" in sys.argv:
    Logger.debug_enabled = True

for arg in sys.argv:
    if str(arg).lower() in exploits:
        exploits[str(arg).lower()].run()
